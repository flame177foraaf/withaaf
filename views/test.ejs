<!DOCTYPE html>
<html>
  <head>
    <%- include ('head') %>
    <title><%= title%></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />

    <style media="screen">
    </style>
    <script type="text/javascript">
      function checkonclick() {
        if (document.add.datalistname.value == "" || document.add.title.value == null || document.add.datalistname.value == undefined || ( document.add.datalistname.value != null && typeof document.add.datalistname.value == "object" && !Object.keys(document.add.datalistname.value).length ) ) {
          alert("내용을 입력해주세요!");
          document.add.datalistname.focus();
          return false;
        }
        return true;
      }
      var pageurl = "?searchText=<%- Search %>&searchType=<%- SearchType %>"
      for (var i = 0; i < Searchcount; i++) {
       pageurl = pageurl + "&searchText2=<%- Search22[i] %>&searchType2=<%- SearchType22[i] %>"
      }
    </script>

    <script  src="https://code.jquery.com/jquery-3.5.1.min.js">    </script>
    <script type="text/javascript">
      $(document).on("click","input[name=findadd]",function(){

      var addStaffText =
      '<div class="" id="seach_form_id2" name="seach_form_id2">'
      +'<input type="text" placeholder="모든 항목" name="searchText2" style="width:200px">'
      + '<select name="searchType2">'
      +    '<option value="wpproperty">속성</option>'
      +    '<option value="wpfeat">피트</option>'
      +    '<option value="wpcustom">커스텀</option>'
      +'</select>'
      +'<button class="btn btn-default" name="delStaff">삭제</button>'
      +'</div>'
      var aaa = $( "div[name=seach_form_id2]:last" ); //last를 사용하여 trStaff라는 명을 가진 마지막 태그 호출

      aaa.after(addStaffText); //마지막 trStaff명 뒤에 붙인다.

      });

      //삭제 버튼
      $(document).on("click","button[name=delStaff]",function(){

          var aaa = $(this).parent();

          aaa.remove(); //tr 테그 삭제
      });
    </script>
  </head>
  <body style="">
    <div class="title_div" >
      <h1><%= title %></h1>

    </div>
    <div class="">
      <form action="/test/1" method="get">
        <div class="" id="seach_form_id" name="seach_form_id">

          <input type="text" placeholder="모든 항목" name="searchText" style="width:200px">
          <select name="searchType">
              <option value="wpname">이름</option>
              <option value="wpproperty">속성</option>
              <option value="wpfeat">피트</option>
              <option value="wpcustom">커스텀</option>
          </select>
          <input action="" type="submit" class="btn" value="찾기" ></button>
          <input type="button" name="findadd" class="btnAdd" value="Add">
        </div>
        <div class="" id="" name="seach_form_id2">

        </div>

      </form>
    </div>

    <div class="">
      <table id="eqtable" style="width:100%;">
        <colgroup>
          <col width="100">
          <col width="200">
          <col width="50">
          <col width="50">
          <col width="100">
          <col width="200">
          <col width="350">
          <col width="300">
          <col width="650">
        </colgroup>
        <thead>
          <tr  style='text-align: center'>
            <th>등급</th>
            <th>이름</th>
            <th>제한</th>
            <th>소켓</th>
            <th>에테르</th>
            <th>성능</th>
            <th>속성</th>
            <th>피트</th>
            <th>커스텀</th>
          </tr>
        </thead>
        <%# tbody에 잇는 스타일은 '\n ' 줄바꿈을 표현함 %>
        <tbody>
          <% if(typeof(CurrentPage) === 'undefined'){ %>
            <tr>
              <td colspan="9"; style= "text-align:center;"> 검색이 필요합니다.</td>
            </tr>
          <% } else if (typeof(data[0]) === 'undefined'){ %>
            <tr>
              <div class="" id="pagelist" >
                <td colspan="9" style= "text-align:center; font-size:24px">
                  해당하는 데이터가 없습니다.
                </td>
              </div>
            </tr>
          <% } else { %>
            <% data.forEach(function(item) { %>
              <% if (item.wpproperty.indexOf('/') != -1){ %>
                <% var WpP = item.wpproperty.split('/') %>
                <% if ( WpP[1] == ' 불 ') { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px; background-color:#FFD5DD">
                <% } else if (WpP[1] == ' 물 ' ) { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px; background-color:#DBE0FC">
                <% } else if (WpP[1] == ' 바람 ') { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px; background-color:#CEFFD3">
                <% } else if (WpP[1] == ' 땅 ') { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px; background-color:#F8EAD8">
                <% } else if (WpP[1] == ' 정신 ') { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px; background-color:#FFFFDB">
                <% } else if (WpP[1] == ' 아스트랄 ') { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px; background-color:#E4C1F2">
                <% } else if (WpP[1] == ' 무속성 ') { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px; background-color:#EAEAEA">
                <% } else { %>
                  <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px;">
                <% } %>
              <% } else { %>
                <tr class="" id="tabletr" style="white-space: pre-line; font-size:12px;">
              <% } %>
              <td><%- item.wpgrade %></td>
              <td><%- item.wpname %></td>
              <td style='text-align: center'><%- item.wplimit %></td>
              <td style='text-align: center'><%- item.wpsocket %></td>
              <td style='text-align: center'><%- item.wpether %></td>
              <td style='text-align: center'><%- item.wpstats %></td>
              <td style='text-align: center'><%- item.wpproperty %></td>
              <td><%- item.wpfeat %></td>
              <td><%- item.wpcustom %></td>
            </tr>
            <% }); %>
          <% } %>
        <div class="" id="pagelist">
          <% if(typeof(CurrentPage) === 'undefined'){ %>
            <tr>
              <div class="" id="pagelist" >
                <td colspan="9" style= "text-align:center; font-size:24px">
                  검색이 필요합니다.
                </td>
              </div>
            </tr>

          <% } else { %>
            <tr>
              <div class="" id="pagelist">
                <td colspan="21" style= "text-align:center; font-size:24px">
                  <% if (SearchPlus == ""){ %>
                    <% if (CurrentPage > PageSize){ %>
                      <% Search= Search.replace(/&/g,"%26").replace(/\+/g,"%2B"); %>

                      <a href="/test/1?searchText=<%-Search %>&searchType=<%- SearchType %>"> ◀◀ </a>
                      <a href="/test/<%- StartPage-1 %>?searchText=<%- Search %>&searchType=<%- SearchType %>"> ◀ </a>
                    <% } %>
                    <% for (var iCount = StartPage; iCount <= EndPage; iCount++ ){ %>
                      <% if (iCount == CurrentPage) { %>
                        <b class="btnnonactive"><%- iCount %></b>
                      <% } else { %>
                        <% Search= Search.replace(/&/g,"%26").replace(/\+/g,"%2B"); %>

                        <a href="/test/<%- iCount %>?searchText=<%- Search %>&searchType=<%- SearchType %>" class="btnactive"><%- iCount %></a>
                      <% } %>
                    <% } %>
                    <% if (EndPage < TotalPage){ %>
                      <% Search= Search.replace(/&/g,"%26").replace(/\+/g,"%2B"); %>

                      <a href="/test/<%- EndPage+1 %>?searchText=<%- Search %>&searchType=<%- SearchType %>">  ▶ </a>
                      <a href="/test/<%- TotalPage %>?searchText=<%- Search %>&searchType=<%- SearchType %>"> ▶▶ </a>
                    <% } %>
                  <% } else { %>


                    <% if (CurrentPage > PageSize){ %>
                      <% Search= Search.replace(/&/g,"%26").replace(/\+/g,"%2B"); %>

                      <a href="/test/1<%= pageurl %>"> ◀◀ </a>
                      <a href="/test/<%- StartPage-1 %><%= pageurl %>"> ◀ </a>
                    <% } %>
                    <% for (var iCount = StartPage; iCount <= EndPage; iCount++ ){ %>
                      <% if (iCount == CurrentPage) { %>
                        <b class="btnnonactive"><%- iCount %></b>
                      <% } else { %>
                        <% Search= Search.replace(/&/g,"%26").replace(/\+/g,"%2B"); %>

                        <a href="/test/<%- iCount %><%= pageurl %>" class="btnactive"><%- iCount %></a>
                      <% } %>
                    <% } %>
                    <% if (EndPage < TotalPage){ %>
                      <% Search= Search.replace(/&/g,"%26").replace(/\+/g,"%2B"); %>

                      <a href="/test/<%- EndPage+1 %><%= pageurl %>">  ▶ </a>
                      <a href="/test/<%- TotalPage %><%= pageurl %>"> ▶▶ </a>
                    <% } %>
                  <% } %>

                </td>
              </div>
            </tr>
          <% } %>
        </div>
        </tbody>
      </table>
    </div>

    <% if(typeof(data[0]) === 'undefined'){ %>
      <div class="" style="text-align: center">
        <div class="">
          <form class="" action="/addwp" method="get">
             <button onclick=location.href="/test/addwp" type="button" name="button" style="width:200px">신규등록</a></button>
          </form>
        </div>
      </div>
    <% } else { %>
    <div class="" style="text-align: center">
      <div class="">
        <form class="" action="/test/addwp" method="get">
           <button onclick=location.href="/test/addwp" type="button" name="button" style="width:200px">신규등록</a></button>
        </form>
      </div>

      <form class="" name="add" action="/test/fixwp" method="get"  onsubmit="return checkonclick()">
        <input type=text list=browsers style="" checked value="<%= data[0].wpname %>" name="Seachname">
        <%# 밸류값을 %=title 과 같이 해주면 받아오는 title 값에 따라 value 값이 달라지게 된다. %>
          <datalist id="browsers" name="datalistname" class="" style="width:50%">
            <% data.forEach(function(item) { %>
            <option value='<%= item.wpname%>' style=""><%- item.wpname%></option>
            <% }); %>
          </datalist>
        <input action="/fixwp" type="submit" class="btn" value="변경하기" ></button>
      </form>
      <form class="" name="" action="/Assemblywp" method="get"  onsubmit="return checkonclick()">
        <input type=text list=browsers style="" checked value="<%= data[0].wpname %>" name="assembly">
        <%# 밸류값을 %=title 과 같이 해주면 받아오는 title 값에 따라 value 값이 달라지게 된다. %>
          <datalist id="browsers" name="datalistname" class="" style="width:50%">
            <% data.forEach(function(item) { %>
            <option value='<%= item.wpname%>' style=""><%- item.wpname%></option>
            <% }); %>
          </datalist>
        <input action="/" type="submit" class="btn" value="재조립하기" ></button>
      </form>
    </div>
    <% } %>
  </body>
  <footer>
    <%- include ('footer')%>
  </footer>
</html>
